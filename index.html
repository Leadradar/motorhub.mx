<!doctype html>
<html lang="es-MX">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MotoUrbano MX — Equipo y accesorios para motociclistas</title>
    <meta name="description" content="Equipo y accesorios para motociclistas, precios claros y soporte por WhatsApp. Devoluciones en 14 días." />
    <meta name="theme-color" content="#ffffff" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="MotoUrbano MX" />
    <meta property="og:description" content="Equipo y accesorios para motociclistas." />
    <meta property="og:image" content="https://leadradar.github.io/motorhub.mx/img/hero.jpg" />

    <link rel="icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="manifest" href="site.webmanifest" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root{
            --bg:#ffffff; --elev:#ffffff; --ink:#0b0b0b; --muted:#5d5d5d; --line:#e9e9e9;
            --accent:#cf0a0a; --accent-weak:#fbecec; --shadow:0 10px 30px rgba(0,0,0,.08);
            --header-pad-y:14px; --header-logo:84px; --header-title:22px; --header-h:220px;
        }
        *{box-sizing:border-box}
        html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
        img{display:block;max-width:100%;height:auto;-webkit-user-drag:none;user-drag:none}
        a{color:inherit;text-decoration:none}
        button{font:inherit}
        .container{max-width:1200px;margin:0 auto;padding:0 28px}
        .grid{display:grid;gap:16px}
        @media(min-width:700px){.grid.cols-2{grid-template-columns:repeat(2,1fr)}}
        @media(min-width:900px){.grid.cols-3{grid-template-columns:repeat(3,1fr)}.grid.cols-4{grid-template-columns:repeat(4,1fr)}.grid.cols-5{grid-template-columns:repeat(5,1fr)}}
        .card{background:var(--elev);border:1px solid var(--line);border-radius:18px;overflow:hidden}
        .shadow{box-shadow:var(--shadow)}
        .accent-perma{background:var(--accent-weak)!important;border-color:var(--accent)!important;box-shadow:inset 0 0 0 2px var(--accent-weak)!important}
        header.site{position:sticky; top:0; z-index:40; background:#fff; border-bottom:1px solid var(--line); transition:padding .18s ease, box-shadow .18s ease}
        .header-wrap{display:flex;flex-direction:column;align-items:center;gap:8px;padding:var(--header-pad-y) 0}
        .brand-stack{display:flex;flex-direction:column;align-items:center;gap:6px}
        .brand-stack img{height:var(--header-logo);width:auto;transition:height .18s ease}
        .brand-title{font:800 var(--header-title)/1 Poppins,system-ui;text-align:center;transition:font-size .18s ease}
        .flag-mx{margin-top:2px}
        .flag-mx svg{width:22px;height:14px;display:block}
        nav.menu{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;margin-top:6px}
        nav.menu a{padding:6px 10px;border-radius:10px;color:#333;font-size:14px;border:1px solid transparent;transition:background .15s, border-color .15s, box-shadow .15s}
        nav.menu a:hover,nav.menu a.is-active{background:var(--accent-weak);border-color:var(--accent);box-shadow:inset 0 0 0 2px var(--accent-weak)}
        nav.menu a:focus-visible{outline:2px solid var(--accent)}
        #cartBtn{font-weight:700}
        @media(max-width:640px){:root{ --header-pad-y:8px; --header-logo:60px; --header-title:18px;} nav.menu{gap:8px} nav.menu a{padding:5px 8px;font-size:13px}}
        header.site.is-scrolled{ box-shadow:0 6px 18px rgba(0,0,0,.06)}
        header.site.is-scrolled .brand-stack img{height:52px}
        header.site.is-scrolled .brand-title{font-size:18px}
        header.site.is-scrolled .header-wrap{padding:8px 0}
        section{scroll-margin-top:calc(var(--header-h) + 8px); content-visibility:auto; contain-intrinsic-size:auto 600px;}
        .hero{border-bottom:1px solid var(--line);background:#fff}
        .hero .wrap{display:flex;flex-direction:column;align-items:center;gap:14px;padding:36px 0}
        .hero .logo-big img{width:340px;height:auto}
        @media(min-width:1100px){.hero .logo-big img{width:400px}}
        @media(max-width:520px){.hero .logo-big img{width:220px}}
        h1{font-family:Poppins,system-ui;font-weight:800;letter-spacing:.2px;font-size:clamp(30px,5vw,52px);line-height:1.04;margin:.05em 0 .1em;text-align:center}
        .hero-sub{font-size:clamp(14px,2.2vw,18px);color:#333;margin:2px 0 6px;text-align:center}
        h2{font-size:clamp(22px,3.6vw,34px);margin:0 0 10px;text-align:center}
        .sub{color:var(--muted);text-align:center}
        .chips-row{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:center;margin-top:14px}
        .chip{display:inline-flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--line);color:#333;padding:8px 12px;border-radius:12px;white-space:nowrap}
        #categorias h2,#categorias .sub{text-align:center}
        .tile{position:relative;border-radius:16px;overflow:hidden;border:1px solid var(--line);background:#fff;cursor:pointer;transition:box-shadow .15s, border-color .15s}
        .tile img{width:100%;height:200px;object-fit:cover}
        .tile .label{position:absolute;left:50%;bottom:10px;transform:translateX(-50%);background:#000000b3;padding:8px 10px;border-radius:10px;color:#fff;font-weight:800}
        .tile:hover{border-color:var(--accent); box-shadow:inset 0 0 0 2px var(--accent-weak)}
        #productos{padding-bottom:30px}
        #productos .filters{display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin:12px 0 6px}
        .pill{border:1px solid #000;background:#fff;border-radius:999px;padding:8px 12px;cursor:pointer;transition:border-color .15s, box-shadow .15s, background .15s}
        .pill:hover,.pill.is-active{background:var(--accent-weak);border-color:var(--accent);box-shadow:inset 0 0 0 2px var(--accent-weak)}
        #gridProds{justify-items:center; padding:0 8px}
        .prod{display:flex;flex-direction:column;cursor:pointer;transition:box-shadow .15s, border-color .15s; width:100%; max-width:500px; margin:0 4px; border:1px solid var(--line); border-radius:18px}
        .prod .img-wrap{position:relative; width:100%}
        .prod .img-wrap img{aspect-ratio:1/1;object-fit:cover;background:#f4f4f4; width:100%; height:auto; display:block; transition:opacity .18s ease}
        .prod .img-wrap img.hover-img{position:absolute; inset:0; opacity:0}
        .prod.ready:hover .img-wrap img.hover-img{opacity:1}
        .prod.ready:hover .img-wrap img.base-img{opacity:0}
        .prod .pad{padding:12px; text-align:center}
        .prod .title{font-weight:700;line-height:1.25;margin:0 0 6px;font-size:16px}
        .prod .meta{display:flex;justify-content:center;align-items:center; gap:10px}
        .price-badge{display:inline-block;background:var(--accent-weak);border:1px solid var(--accent);border-radius:999px;padding:6px 10px;font-weight:800}
        .stars{color:#000;font-size:13px}
        .prod:hover{border-color:var(--accent); box-shadow:inset 0 0 0 2px var(--accent-weak)}
        .hidden{display:none !important}
        .btn{display:inline-flex;align-items:center;gap:8px;background:#fff;color:#000;border:1px solid var(--accent);border-radius:12px;padding:10px 14px;cursor:pointer;transition:background .15s,border-color .15s, box-shadow .15s}
        .btn:hover{background:var(--accent-weak);border-color:var(--accent);box-shadow:inset 0 0 0 2px var(--accent-weak)}
        .close{border:none;background:#f3f3f3;border-radius:10px;padding:8px 10px;cursor:pointer}
        .modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:60}
        .modal.open{display:flex}
        .modal-card{background:#fff;border-radius:18px;max-width:1120px;width:min(96vw,1120px);max-height:92vh;display:flex;flex-direction:column;overflow:hidden;border:1px solid var(--line);margin:auto}
        .modal-head{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--line)}
        .modal-title{font:700 18px/1.2 Poppins,system-ui}
        .modal-body{display:grid;gap:16px;padding:16px;overflow:auto;align-items:start}
        @media(min-width:900px){.modal-body.prod{grid-template-columns:60% 40%}}
        .media-wrap{position:relative}
        .m-main{width:100%;max-height:80vh;object-fit:contain;border-radius:12px;background:#f7f7f7;cursor:zoom-in}
        .m-main.is-loading{background:linear-gradient(90deg,#f3f3f3 25%,#e9e9e9 37%,#f3f3f3 63%);background-size:400% 100%;animation:sheen 1.2s infinite}
        @keyframes sheen{0%{background-position:100% 0}100%{background-position:0 0}}
        .nav-arrow{position:absolute;top:50%;transform:translateY(-50%);background:#ffffffcc;border:1px solid var(--line);border-radius:12px;padding:8px 10px;cursor:pointer}
        .nav-arrow.prev{left:8px}
        .nav-arrow.next{right:8px}
        .thumbs{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:8px}
        .thumbs img{width:100%;height:84px;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer;background:#fafafa}
        .thumbs img.active{border-color:#000}
        .detail-col{display:flex;flex-direction:column;align-items:flex-start}
        .badge-price{display:inline-block;background:var(--accent-weak);border:1px solid var(--accent);border-radius:999px;padding:10px 14px;font:800 22px/1 Poppins,system-ui;margin:0 0 12px}
        .features{list-style:none;padding:0;margin:0 0 16px}
        .features li{position:relative;padding-left:22px;margin:8px 0}
        .features li::before{content:"";position:absolute;left:0;top:7px;width:10px;height:10px;border-radius:50%;background:var(--accent-weak);border:1px solid var(--accent)}
        .lightbox{position:fixed;inset:0;background:#000000eb;display:none;align-items:center;justify-content:center;z-index:80;touch-action:none}
        .lightbox.open{display:flex}
        .lightbox img{max-width:95vw;max-height:95vh;object-fit:contain;transform-origin:center center;transition:transform .06s linear}
        .lightbox .x{position:absolute;top:14px;right:14px;background:#ffffff22;color:#fff;border:1px solid #ffffff55;border-radius:10px;padding:8px 10px;cursor:pointer}
        .lightbox .arrow{position:absolute;top:50%;transform:translateY(-50%);background:#ffffff22;color:#fff;border:1px solid #ffffff55;border-radius:10px;padding:10px 12px;cursor:pointer}
        .lightbox .arrow.prev{left:14px}
        .lightbox .arrow.next{right:14px}
        .cart{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:65}
        .cart.open{display:flex}
        .cart-card{background:#fff;border-radius:18px;max-width:760px;width:96%;max-height:92vh;display:flex;flex-direction:column;overflow:hidden;border:1px solid var(--line)}
        .cart-head{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--line)}
        .cart-head strong{font:700 18px/1.2 Poppins,system-ui}
        .cart-body{padding:12px 16px;overflow:auto}
        .cart-item{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:center;border-bottom:1px solid var(--line);padding:10px 0}
        .cart-item img{width:60px;height:60px;object-fit:cover;border-radius:10px}
        .cart-item .qtyline{display:inline-flex;align-items:center;border:1px solid var(--line);border-radius:10px;overflow:hidden}
        .cart-item .qtyline button{background:#f6f6f6;border:none;padding:6px 10px;cursor:pointer}
        .cart-item .qtyline button:hover{background:var(--accent-weak);border-left:1px solid var(--accent)}
        .cart-item .qtyline input{width:44px;text-align:center;border:none;padding:6px}
        .cart-foot{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-top:1px solid var(--line);gap:10px;flex-wrap:wrap}
        #cTotal{display:inline-block;background:var(--accent-weak);border:1px solid var(--accent);border-radius:999px;padding:6px 10px}
        footer.site{margin-top:48px;border-top:1px solid var(--line);background:#fff}
        .footer-head{display:flex;flex-direction:column;align-items:center;gap:6px;padding:18px 0 6px}
        .footer-head img{height:72px;width:auto}
        .footer-name{font:800 18px/1.1 Poppins,system-ui;text-align:center}
        .footer-tag{color:#666;text-align:center;margin-top:2px}
        .copy{padding:10px 0 20px;color:#666;text-align:center}
        .footer-legal{display:flex;gap:8px;align-items:center;justify-content:center;flex-wrap:wrap}
        .footer-legal .dot{opacity:.35}
        .footer-legal a{padding:4px 6px;border-radius:8px;transition:background .15s, border-color .15s, box-shadow .15s; border:1px solid transparent;}
        .footer-legal a:hover{background:var(--accent-weak);border-color:var(--accent);box-shadow:inset 0 0 0 2px var(--accent-weak)}
        .contact-grid{display:grid;gap:16px;grid-template-columns:1fr;max-width:900px;margin:16px auto 0}
        @media(min-width:900px){.contact-grid{grid-template-columns:repeat(3,1fr)}}
        .contact-item{border:1px solid var(--line);border-radius:16px;padding:18px 16px;text-align:center;transition:box-shadow .15s, border-color .15s}
        .contact-item strong{display:block;font:700 18px/1.2 Poppins,system-ui;margin-bottom:8px}
        .contact-item .sub{line-height:1.6;margin-bottom:12px}
        .contact-item a.btn{display:inline-block;margin-top:2px; border:1px solid var(--accent);}
        .contact-item a.btn:hover{background:var(--accent-weak);border-color:var(--accent);box-shadow:inset 0 0 0 2px var(--accent-weak)}
        .contact-item:hover{border-color:var(--accent); box-shadow:inset 0 0 0 2px var(--accent-weak)}
        #faq details{border:1px solid var(--line);border-radius:12px;margin:10px 0;padding:10px;background:#f6f6f6;transition:border-color .15s, box-shadow .15s}
        #faq details:hover{border-color:var(--accent); box-shadow:inset 0 0 0 2px var(--accent-weak)}
        #faq summary{cursor:pointer;font-weight:700}
        #faq .answer{margin-top:8px}
        .floating-wa{position:fixed; right:16px; bottom:16px; width:64px; height:64px; display:flex; align-items:center; justify-content:center; z-index:45; cursor:pointer}
        .floating-wa img{ width:64px; height:64px; display:block }
        .trustbar {
            display: flex;
            justify-content: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        .modal-body.prod{
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        @media(min-width: 900px) {
            .modal-body.prod {
                flex-direction: row;
                align-items: center; 
            }
        }
        .media-wrap {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .detail-col {
            flex: 1;
            align-items: center;
            text-align: center;
        }
        .m-main {
            flex: 1;
            object-fit: contain;
            width: 100%;
            height: auto;
        }
        .thumbs {
            justify-content: center;
        }
        .features {
            list-style: none;
            padding: 0;
            margin: 0 0 16px;
            text-align: left; 
        }
        .features li {
            position: relative;
            padding-left: 22px;
            margin: 8px 0;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            const $ = (sel,ctx)=> (ctx||document).querySelector(sel);
            const $$= (sel,ctx)=> [].slice.call((ctx||document).querySelectorAll(sel));

            const header = $('#siteHeader');
            const prodCards = $$('#gridProds article.prod');
            const filterPills = $$('#filters .pill');
            const grid = $('#gridProds');
            const cartBtn = $('#cartBtn');

            const modal = $('#modal'), mTitle = $('#mTitle'), mPrice = $('#mPrice'),
                  mMain = $('#mMain'), mThumbs = $('#mThumbs'), mDesc = $('#mDesc'),
                  mPrev = $('#mPrev'), mNext = $('#mNext'),
                  qMinus = $('#qMinus'), qPlus = $('#qPlus'), qInput = $('#qInput'),
                  mAdd = $('#mAdd');
            
            const cartModal = $('#cart'), cBody = $('#cBody'), cTotal = $('#cTotal'), cClear = $('#cClear'),
                  ppAmount = $('#ppAmount'), ppBusiness = $('#ppBusiness]');
            
            const lightbox = $('#lightbox'), lbImg = $('#lbImg'), lbClose = $('#lbClose'),
                  lbPrev = $('#lbPrev'), lbNext = $('#lbNext');
            
            const toast = $('#toast');
            
            let currentProduct = { images:[], index:0, name:'', priceText:'', price:0 };

            function updateHeaderUi(){
              if (!header) return;
              const scrolled = window.scrollY > 8;
              header.classList.toggle('is-scrolled', scrolled);
              document.documentElement.style.setProperty('--header-h', header.getBoundingClientRect().height + 'px');
            }

            function scrollToId(id){
              const el = $(id);
              if(!el || !header) return;
              const headerH = header.getBoundingClientRect().height;
              window.scrollTo({ top: el.getBoundingClientRect().top + window.pageYOffset - headerH - 6, behavior: 'smooth' });
            }
            
            function applyFilter(cat){
              filterPills.forEach(p => p.classList.toggle('is-active', p.dataset.cat === cat));
              prodCards.forEach(card => card.classList.toggle('hidden', !(cat === 'all' || card.dataset.cat === cat)));
              scrollToId('#productos');
            }

            function openModal(modalEl) { modalEl?.classList.add('open'); }
            function closeModal(modalEl) { modalEl?.classList.remove('open'); }
            
            const MU_LEGAL = {
                envios:{title:'Política de Envíos — MotoUrbano MX',body:'<p>Envíos a todo México mediante mensajería certificada. Tiempo estimado: <strong>10 a 20 días hábiles</strong> según tu zona.</p><p>Compartimos tu <strong>número de guía</strong> por correo para rastreo.</p><p>Si hay retrasos de paquetería, te acompañamos en todo momento.</p><p class="sub">Contacto: <a href="mailto:hola@motourbano.shop">hola@motourbano.shop</a></p>'},
                devoluciones:{title:'Política de Devoluciones — MotoUrbano MX',body:'<p>Tienes <strong>14 días naturales</strong> desde la entrega para solicitar devolución.</p><p>El producto debe estar <strong>sin uso</strong> y con empaques/etiquetas completos.</p><p>Escríbenos a <a href="mailto:hola@motourbano.shop">hola@motourbano.shop</a> o por WhatsApp con tu <strong>número de pedido</strong>.</p><p>Tras validar, hacemos reembolso por el mismo medio de pago.</p>'},
                privacidad:{title:'Aviso de Privacidad — MotoUrbano MX',body:'<p>Usamos tus datos para <strong>gestión de pedidos</strong>, atención y comunicaciones.</p><p>Compartimos lo mínimo con terceros (paquetería, pagos) o por obligación legal.</p><p>Derechos ARCO: <a href="mailto:hola@motourbano.shop">hola@motourbano.shop</a>.</p>'},
                terminos:{title:'Términos y Condiciones — MotoUrbano MX',body:'<p>El uso del sitio implica aceptación de estos términos. Precios y disponibilidad pueden cambiar.</p><p>Imágenes ilustrativas. Si hay error o falta de inventario, se puede cancelar con reembolso íntegro.</p><p>Dudas: <a href="mailto:hola@motourbano.shop">hola@motourbano.shop</a>.</p>'}
            };

            function MU_openLegal(key){
                const data = MU_LEGAL[key];
                if(!data) return;
                const modal = document.getElementById('legalModal');
                const body = document.getElementById('legalBody');
                const title = document.getElementById('legalTitle');
                if(!modal || !body || !title) return;
                title.textContent = data.title;
                body.innerHTML = `<div class="sub" style="text-align:left">${data.body}</div>`;
                modal.classList.add('open');
            }

            function MU_openMailModal(){
                const modal = document.getElementById('emailModal');
                if(modal) modal.classList.add('open');
            }

            function MU_copyEmail(){
                const email = 'hola@motourbano.shop';
                navigator.clipboard?.writeText(email);
                showToast('Correo copiado');
            }
            
            function getProductData(card){
              const name = card.dataset.name;
              const priceText = card.dataset.price;
              const price = parseInt((priceText || '').replace(/[^0-9]/g, ''), 10) || 0;
              const mainImage = card.dataset.main || '';
              let gallery = [];
              try { gallery = JSON.parse(card.dataset.gallery || '[]'); } catch(e) {}
              const images = [mainImage].concat(gallery.filter(Boolean));
              const desc = (card.dataset.desc || '').split('·').map(s => s.trim()).filter(Boolean);
              return { name, priceText, price, mainImage, images, desc };
            }
            
            function showImageInModal(idx){
              if (!currentProduct.images.length) return;
              currentProduct.index = (idx + currentProduct.images.length) % currentProduct.images.length;
              const nextSrc = currentProduct.images[currentProduct.index];
              
              mMain.classList.add('is-loading');
              const img = new Image();
              img.src = nextSrc;
              img.onload = () => {
                mMain.src = nextSrc;
                mMain.alt = currentProduct.name;
                mMain.classList.remove('is-loading');
                $$('#mThumbs img').forEach(t => t.classList.toggle('active', t.src === nextSrc));
              };
            }
            
            function openProductModal(card){
              currentProduct = getProductData(card);
              mTitle.textContent = currentProduct.name || 'Producto';
              mPrice.textContent = currentProduct.priceText || '';
              mMain.src = currentProduct.mainImage;
              mMain.alt = currentProduct.name;
              mThumbs.innerHTML = currentProduct.images.map((src, i) =>
                `<img data-src="${src}" alt="Vista ${i + 1} de ${currentProduct.name}" loading="lazy" src="${src}" class="${i === 0 ? 'active' : ''}">`
              ).join('');
              mDesc.innerHTML = currentProduct.desc.map(li => `<li>${li}</li>`).join('');
              qInput.value = 1;
              openModal(modal);
              currentProduct.images.slice(1).forEach(src => { const img = new Image(); img.src = src; });
            }
            
            function openLightbox(src, alt){
              if (!lbImg || !lightbox) return;
              lbImg.src = src; lbImg.alt = alt || '';
              lightbox.classList.add('open');
            }

            const STORAGE_KEY = 'mu_cart';
            const readCart = () => { try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); } catch(e) { return []; } };
            const writeCart = items => localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
            const cartSum = items => items.reduce((s, i) => s + i.price * i.qty, 0);
            
            function updateCartCount(){
              const count = readCart().reduce((s, i) => s + i.qty, 0);
              $('#cartCount').textContent = count;
            }
            
            function renderCart(){
              const items = readCart();
              const emptyCartHTML = '<p class="sub">Tu carrito está vacío.</p>';
              
              if(cBody){
                cBody.innerHTML = items.length === 0
                  ? emptyCartHTML
                  : items.map((i, idx) => `
                      <div class="cart-item">
                        <img src="${i.img}" alt="${i.name}" loading="lazy" decoding="async">
                        <div><div style="font-weight:700">${i.name}</div><div class="sub">$${i.price} MXN c/u</div></div>
                        <div style="display:flex;align-items:center;gap:8px">
                          <div class="qtyline">
                            <button type="button" data-act="minus" data-idx="${idx}" aria-label="Quitar uno">−</button>
                            <input type="number" min="1" value="${i.qty}" data-idx="${idx}" data-act="input" />
                            <button type="button" data-act="plus" data-idx="${idx}" aria-label="Añadir uno">+</button>
                          </div>
                          <button class="close" type="button" data-del="${idx}">Eliminar</button>
                        </div>
                      </div>`
                  ).join('');
              }
              const total = cartSum(items);
              if(cTotal) cTotal.textContent = `$${total} MXN`;
              if(ppAmount) ppAmount.value = Number(total).toFixed(2);
              if(ppBusiness) ppBusiness.value = 'tu-correo-paypal@ejemplo.com';
            }
            
            function showToast(txt){
              if(!toast) return;
              if(txt) toast.textContent = txt;
              toast.style.opacity = '1';
              toast.style.transform = 'translateX(-50%) translateY(-6px)';
              setTimeout(()=>{
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(-50%)';
              }, 1400);
            }

            prodCards.forEach(card => {
              let gallery = [];
              try { gallery = JSON.parse(card.dataset.gallery || '[]'); } catch(e) {}
              const secondImageSrc = gallery[0] || null;
              if (!secondImageSrc) return;
              const img = new Image();
              img.src = secondImageSrc;
              img.onload = () => {
                  const wrap = card.querySelector('.img-wrap');
                  const h = document.createElement('img');
                  h.className='hover-img';
                  h.alt=(card.dataset.name||'')+' vista';
                  h.loading='lazy'; h.decoding='async';
                  h.src=secondImageSrc;
                  const existingHoverImg = wrap.querySelector('.hover-img');
                  if(existingHoverImg) wrap.removeChild(existingHoverImg);
                  wrap.appendChild(h);
                  card.classList.add('ready');
              };
            });

            window.addEventListener('scroll', updateHeaderUi, { passive: true });
            window.addEventListener('resize', updateHeaderUi);
            $$('.menu a[href^="#"]').forEach(a => a.addEventListener('click', function(e){
                e.preventDefault();
                const id = this.getAttribute('href');
                if (id && id.length > 1) scrollToId(id);
            }));

            const filtersContainer = $('#filters');
            if (filtersContainer) filtersContainer.addEventListener('click', e => {
              const pill = e.target.closest('.pill');
              if (pill) applyFilter(pill.dataset.cat);
            });
            
            const categoriesContainer = $('.grid.cols-2.cols-5');
            if (categoriesContainer) categoriesContainer.addEventListener('click', e => {
              const tile = e.target.closest('.js-cat');
              if (tile) applyFilter(tile.dataset.cat);
            });

            document.body.addEventListener('click', e => {
              const card = e.target.closest('article.prod');
              if (card && grid.contains(card)) {
                openProductModal(card);
                return;
              }
              
              const cartButton = e.target.closest('#cartBtn');
              if(cartButton) {
                e.preventDefault();
                renderCart();
                openModal(cartModal);
                return;
              }

              const closeButton = e.target.closest('.close') || e.target.closest('.x');
              const modalToClose = closeButton?.closest('.modal, .lightbox');
              if(modalToClose) {
                closeModal(modalToClose);
                return;
              }

              const openModals = $$('.modal.open, .lightbox.open');
              openModals.forEach(modalEl => {
                if(e.target === modalEl) {
                  closeModal(modalEl);
                }
              });
              
              const legalLink = e.target.closest('[data-legal-key]');
              if(legalLink) {
                  e.preventDefault();
                  MU_openLegal(legalLink.dataset.legalKey);
              }
              
              const emailLink = e.target.closest('[data-action="open-email-modal"]');
              if(emailLink) {
                  e.preventDefault();
                  MU_openMailModal();
              }

              const copyEmailBtn = e.target.closest('[data-action="copy-email"]');
              if(copyEmailBtn) {
                  e.preventDefault();
                  MU_copyEmail();
              }
            });

            document.addEventListener('keydown', e => {
              if(e.key === 'Escape') {
                $$('.modal.open, .lightbox.open').forEach(el => closeModal(el));
              }
            });

            if (mThumbs) mThumbs.addEventListener('click', e => {
              const img = e.target.closest('img');
              if (img) showImageInModal(currentProduct.images.indexOf(img.getAttribute('data-src')));
            });

            if (mMain) mMain.addEventListener('click', () => openLightbox(mMain.src, mMain.alt));
            if (mPrev) mPrev.addEventListener('click', () => showImageInModal(currentProduct.index - 1));
            if (mNext) mMain.addEventListener('click', () => showImageInModal(currentProduct.index + 1));
            
            cClear?.addEventListener('click', () => { writeCart([]); updateCartCount(); renderCart(); });
            
            if(cBody){
                cBody.addEventListener('click', e => {
                    const btn = e.target.closest('button[data-act], button[data-del]');
                    if (!btn) return;
                    const idx = parseInt(btn.dataset.idx || btn.dataset.del, 10);
                    const items = readCart();
                    if (!items[idx]) return;
                    if (btn.dataset.act === 'minus') items[idx].qty = Math.max(1, items[idx].qty - 1);
                    else if (btn.dataset.act === 'plus') items[idx].qty = items[idx].qty + 1;
                    else if (btn.dataset.del) items.splice(idx, 1);
                    writeCart(items);
                    updateCartCount();
                    renderCart();
                });
                cBody.addEventListener('change', e => {
                    const input = e.target.closest('input[data-act="input"]');
                    if (!input) return;
                    const idx = parseInt(input.dataset.idx, 10);
                    const items = readCart();
                    if (!items[idx]) return;
                    items[idx].qty = Math.max(1, parseInt(input.value, 10) || 1);
                    writeCart(items);
                    updateCartCount();
                    renderCart();
                });
            }
            
            if (mAdd) mAdd.addEventListener('click', () => {
              const qty = Math.max(1, parseInt(qInput.value, 10) || 1);
              const items = readCart();
              const found = items.find(it => it.name === currentProduct.name);
              if (found) found.qty += qty;
              else items.push({ name: currentProduct.name, price: currentProduct.price, img: currentProduct.mainImage, qty });
              writeCart(items);
              updateCartCount();
              renderCart();
              closeModal(modal);
              showToast('Añadido al carrito');
            });

            updateHeaderUi();
            updateCartCount();
            if(location.hash) setTimeout(() => scrollToId(location.hash), 50);

            prodCards.forEach(card => {
              let gallery = [];
              try { gallery = JSON.parse(card.dataset.gallery || '[]'); } catch(e) {}
              const secondImageSrc = gallery[0] || null;
              if (!secondImageSrc) return;
              const img = new Image();
              img.src = secondImageSrc;
              img.onload = () => {
                  const wrap = card.querySelector('.img-wrap');
                  const h = document.createElement('img');
                  h.className='hover-img';
                  h.alt=(card.dataset.name||'')+' vista';
                  h.loading='lazy'; h.decoding='async';
                  h.src=secondImageSrc;
                  const existingHoverImg = wrap.querySelector('.hover-img');
                  if(existingHoverImg) wrap.removeChild(existingHoverImg);
                  wrap.appendChild(h);
                  card.classList.add('ready');
              };
            });
        });
    </script>
</body>
</html>
